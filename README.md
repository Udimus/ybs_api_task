# ybs_api_task
REST API для вступительного задания в ШБРЯ.

### Установка
Подразумевается, что в месте установки нет проблем с доступом в интернет. В противном случае в соотвествующие места вызова докера понадобится добавить информацию о прокси.

Сперва установим и настроим docker:

`sudo apt  install docker.io`

`sudo apt  install docker-compose`

Нам нужно добавить себя в группу docker, чтобы не писать всё время sudo:

`sudo groupadd docker`

`sudo usermod -aG docker $USER`

Заранее скачаем нужные нам образы:

`docker pull postgres:alpine`

`docker pull python:3.6-slim-stretch`


### Запуск всего сервиса

В директории проекта:

`docker-compose up -d`

Первый раз это займёт некоторое время на сборку build'а для сервиса.




### Что можно сделать лучше

* Разобраться с SQLAlchemy и её связкой с Flask -- возможно, держать всё время соединение с БД лучше;
* Хранить данные дней рождений не в строчном виде (но тогда их надо аккуратно преобразовывать);
* Вынести агрегационные задачи в запросы к самой БД (про дни рождения и про возрасты);
* Больше узнать, как устроено логирование с Flask (и вообще, что это за сущность -- app);
* Каждый раз считать максимальный номер таблицы, чтобы присвоить очередной таблице итерируемый номер -- так себе затея. Но альтернативные варианты (просто считать число таблиц... хранить на диске (в контейнере?) файл с этим числом итератором... назначать номер из текущего таймстемпа...) выглядят ещё более сомнительными;
* Есть ещё такая тема, как SQL-инъекции. По идее, как раз средства psycopg2 должны от них защищать, а на деле -- они толком не могут сформировать запрос. Вообще, очень интересно, где человеческие базы данных, которым можно передать сразу файл...
